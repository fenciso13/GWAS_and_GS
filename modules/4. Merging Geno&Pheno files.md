# Merge blups and genotypes

*Seting up parameters*
```{r}

## Parameters
  rm(list=ls())
  setwd("/Users/fenciso/Desktop/Thesis/GWAS_GS/r")
  phenoFile<-'SCAB_blups.RData'
  #genoFile<-'X_X.RData'
  GMatrixFile='G_TETRA.RData'
  traitName<-"SCAB"
  matrix<-X_filter

###

  load(phenoFile)
  #load(genoFile)
  load(GMatrixFile)

  ## Removing lines without genotype
  tmp<-which(!names(blups)%in%rownames(matrix))
  if(length(tmp)>0){ blups<-blups[-tmp]}


  ## Removing lines without genotype
  tmp<-which(!rownames(matrix)%in%names(blups))
  if(length(tmp)>0){matrix<-matrix[-tmp,]}

  stopifnot(all(names(blups)%in%rownames(matrix)))
  stopifnot(all(rownames(matrix)%in%names(blups)))

   # Now we sort
   tmp<-order(as.integer(factor(x=names(blups),levels=rownames(matrix),ordered=TRUE)))
   blups<-blups[tmp]
   stopifnot(all(names(blups)==rownames(matrix)))
   X_filter2=matrix
   save(X_filter2,blups,file=paste0(traitName,'_X_GEN_PHEN.RData'))
### end of data preparation

```
````
[Next_module](https://github.com/fenciso13/GWAS_and_GS/blob/master/modules/5.%20GWAS.md)

[Back](https://github.com/fenciso13/GWAS_and_GS)
