# Merge blups and genotypes

*Setting up parameters*
```{r}
rm(list=ls())
setwd("/Users/fenciso/Desktop/Thesis/GWAS_GS/r")
phenoFile<-'SCAB_blups.RData'
#genoFile<-'X_X.RData'
GMatrixFile='G_TETRA.RData'
traitName<-"SCAB"
```
*Loading files*

```{r}
load(phenoFile)
load(GMatrixFile)
genoFile=X_filter
```
*Removing lines without genotype/phenotype*

```{r}
tmp<-which(!names(blups)%in%rownames(genoFile))
if(length(tmp)>0){ blups<-blups[-tmp]}

tmp<-which(!rownames(genoFile)%in%names(blups))
if(length(tmp)>0){genoFile<-genoFile[-tmp,]}

stopifnot(all(names(blups)%in%rownames(genoFile)))
stopifnot(all(rownames(genoFile)%in%names(blups)))
```
*Sorting and saving files*

```{r}
tmp<-order(as.integer(factor(x=names(blups),levels=rownames(genoFile),ordered=TRUE)))
blups<-blups[tmp]
stopifnot(all(names(blups)==rownames(genoFile)))

X_filter2=genoFile
save(X_filter2,blups,file=paste0(traitName,'_X_GEN_PHEN.RData'))
```

[Next_module](https://github.com/fenciso13/GWAS_and_GS/blob/master/modules/5.%20GWAS.md)

[Back](https://github.com/fenciso13/GWAS_and_GS)
